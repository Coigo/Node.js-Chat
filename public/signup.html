
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Criar Conta</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300&family=Montserrat:wght@400;600&display=swap');
        * {
            font-family: 'Inter', sans-serif;
            color: aliceblue;
        }
    </style>
</head>
<body class="bg-dark">
    <div class="container">
        <div class="row mt-5">
            <div class="col-5 bg-dark m-5">
                <div class="h1">LOGIN</div>
                <form action="/signup" method="post">
                    <div class="form-group m-5">
                        <label for="username">Nome do Usuário</label>
                        <input class="form-control mb-5" type="text" name="username" id="username" required>
                    </div>
                    <div class="form-group m-5">
                        <label for="password">Senha</label>
                        <input class="form-control" type="password" name="password" id="password" required>
                    </div>
                    <div class="form-group m-5">
                        <label for="password">Confirme a sua senha</label>
                        <input class="form-control" type="password" name="confirm" id="confirm" required>
                    </div>
                </form>
                <div class="form-control bg-dark border-0 m-4">
                    <button class="btn" style="background-color: rgb(130, 29, 203);">Entrar</button>
                    <p>Não tem uma conta? <a style="color: rgb(130, 29, 203); text-decoration: none;" href="signup.html">Crie uma!</a></p>
                </div>
            </div>
            <div class="col-6"></div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <script type="module">

        import { Validate } from './script/index.js'
        import CreateObserver from './script/observer.js'

        document.addEventListener('DOMContentLoaded', () => {
            const observer = CreateObserver()
            const form = document.querySelector('form')
            const submit = document.querySelector('.btn')

            submit.addEventListener('click', (event) => {
                event.preventDefault()

                const confirmation = document.getElementById('confirm').value
                const username = document.getElementById('username').value
                const password = document.getElementById('password').value
                
                const NewUserInfo = { username, password, confirmation }
                observer.Subscribe(Validate)
                const newUserStatus = observer.notifyAll(NewUserInfo)
                observer.unSubscribe(Validate)
                
                const statusFunctions = {
                    'TudoCerto': async () => {
                       await FetchForm(NewUserInfo)
                    },
                    'SenhaCurta': async function() {
                        console.log('Senha Curta')
                    },
                    'SenhasDiferentes': async function() {
                        console.log('Senhas Diferentes')
                    }
                }
                const callStatusFunction = statusFunctions[newUserStatus]()

                async function FetchForm(userInfo) {
                    try {
                        const result = await axios.post("http://localhost:4001/signup", JSON.stringify(userInfo) , {
                            headers: { "Content-Type": "application/json" }
                        })
                        console.log(result)
                    }
                    catch ( err ) {
                        console.log(err)
                    }
                }

            });
        });
    </script>
</body>
</html>


